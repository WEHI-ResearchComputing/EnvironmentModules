<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EnvironmentModules">
<title>Environment Modules • EnvironmentModules</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Environment Modules">
<meta property="og:description" content="EnvironmentModules">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EnvironmentModules</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/WEHI-ResearchComputing/EnvironmentModules/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Environment Modules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/WEHI-ResearchComputing/EnvironmentModules/blob/HEAD/vignettes/README.Rmd" class="external-link"><code>vignettes/README.Rmd</code></a></small>
      <div class="d-none name"><code>README.Rmd</code></div>
    </div>

    
    
<p>The EnvironmentModules package is an R front-end for the <a href="https://modules.readthedocs.io/en/latest/index.html" class="external-link">Environment
Modules</a> project, which offers a way to load and unload packages, and
is commonly used on shared HPC (High Performance Computing)
environments.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Currently <code>EnvironmentModules</code> is not on CRAN, so you will
have to install it as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"WEHI-ResearchComputing/EnvironmentModules"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wehi-researchcomputing.github.io/EnvironmentModules/" class="external-link">EnvironmentModules</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="listing-modules">Listing Modules<a class="anchor" aria-label="anchor" href="#listing-modules"></a>
</h2>
<p>You can list the available modules:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_avail.html">module_avail</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can filter to only modules starting with some prefix:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_avail.html">module_avail</a></span><span class="op">(</span><span class="st">"python"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-and-unloading-modules">Loading and Unloading Modules<a class="anchor" aria-label="anchor" href="#loading-and-unloading-modules"></a>
</h2>
<p>Load modules using <code><a href="../reference/module_load.html">module_load()</a></code>!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_load.html">module_load</a></span><span class="op">(</span><span class="st">"python/3"</span><span class="op">)</span></span></code></pre></div>
<p>If you’ve already loaded a module, you will be notified:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_load.html">module_load</a></span><span class="op">(</span><span class="st">"python/3"</span><span class="op">)</span></span></code></pre></div>
<p>You can unload a module using the corresponding
<code><a href="../reference/module_unload.html">module_unload()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_unload.html">module_unload</a></span><span class="op">(</span><span class="st">"python/3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="listing-loaded-modules">Listing Loaded Modules<a class="anchor" aria-label="anchor" href="#listing-loaded-modules"></a>
</h2>
<p>You can list modules that have been already loaded with
<code><a href="../reference/module_list.html">module_list()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_load.html">module_load</a></span><span class="op">(</span><span class="st">"python/3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/module_list.html">module_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linking-shared-libraries">Linking Shared Libraries<a class="anchor" aria-label="anchor" href="#linking-shared-libraries"></a>
</h2>
<p>Although <code><a href="../reference/module_load.html">module_load()</a></code> will add a module’s libraries to
your <code>LD_LIBRARY_PATH</code>, which will allow you to compile
packages against them, R will not necessarily be able to actually run
packages that use these libraries.</p>
<p>For example, let’s say we want to use the <code>hdf5r</code> package,
which depends on the <code>hdf5</code> library package. We don’t have
<code>hdf5</code> loaded, so it will fail:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"hdf5r"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Let’s see what happens if we load the appropriate module. Firstly, we
need to find out what the module is called:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_avail.html">module_avail</a></span><span class="op">(</span><span class="st">"hdf5"</span><span class="op">)</span></span></code></pre></div>
<p>We can now load the module:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_load.html">module_load</a></span><span class="op">(</span><span class="st">"hdf5/1.12.2"</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s try again:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"hdf5r"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can load the package itself… or can we?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hhoeflin.github.io/hdf5r/" class="external-link">hdf5r</a></span><span class="op">)</span></span></code></pre></div>
<p>As alluded to above, R doesn’t actually load every new library that
becomes available in the environment. Rather it uses “load-time
linking”, which is where the libraries it links to are fixed at the time
you start R. Now, you can resolve the above error by closing R, loading
the module, and then restarting R, but this can be quite annoying.</p>
<p>Fortunately this package supports installing packages in a special
way that hints to the package where to find the modules it needs. This
means that you won’t have to restart R, or even load the modules the
next time you want to use the package:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"hdf5r"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/with_module_install.html">with_module_install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hhoeflin.github.io/hdf5r/" class="external-link">hdf5r</a></span><span class="op">)</span></span></code></pre></div>
<p>It worked!</p>
<p>If you are interested in the theory underlying what is happening
here, you might find this explanation of linking on Linux helpful: <a href="https://techblog.rosedu.org/library-management.html" class="external-link uri">https://techblog.rosedu.org/library-management.html</a>.</p>
</div>
<div class="section level2">
<h2 id="other-commands">Other Commands<a class="anchor" aria-label="anchor" href="#other-commands"></a>
</h2>
<p>This package also supports the following.</p>
<p><code><a href="../reference/module_swap.html">module_swap()</a></code> unloads the first module and loads the
second:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_swap.html">module_swap</a></span><span class="op">(</span><span class="st">"hdf5/1.12.2"</span>, <span class="st">"hdf5/1.10.5"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/module_purge.html">module_purge()</a></code> unloads all modules:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/module_purge.html">module_purge</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-commands">Advanced Commands<a class="anchor" aria-label="anchor" href="#advanced-commands"></a>
</h2>
<p>If you want to use a feature of Environment Modules that does not
(yet) have a dedicated function, you can use the advanced functions
<code>get_module_code</code> or <code>get_module_output</code>.</p>
<p>If you want to run a command that doesn’t edit the modules, but only
shows output, run <code>get_module_output</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_module_output.html">get_module_output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"show"</span>, <span class="st">"hdf5"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the module does edit the modules, use
<code><a href="../reference/get_module_code.html">get_module_code()</a></code>, and evaluate the result:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_module_code.html">get_module_code</a></span><span class="op">(</span><span class="st">"reload"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<blockquote>
<p>Environment Modules <a href="https://modules.readthedocs.io/en/latest/index.html" class="external-link">supports
loading modules in R since version 4.0.0!</a> What is the point of this
package?</p>
</blockquote>
<p>This is true, and actually this package is just a wrapper around that
core functionality. You <em>need</em> Modules version 4.0.0 or above to
run this package. The main advantages of using this wrapper are the
nicer function interfaces, and the ability to automatically link R to
newly loaded libraries.</p>
<blockquote>
<p>I’m getting the error “Could not detect an Environment Modules
installation”, but I know that Environment Modules is installed on my
system. What do I do?</p>
</blockquote>
<p>First, in a bash terminal where the <code>module</code> command works
correctly, run <code>which modulecmd</code>. Then in R, run
<code>Sys.setenv(MODULES_CMD="&lt;/path/to/modulecmd&gt;")</code>,
putting the output from the previous step as the argument value. Then
everything should work!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Milton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
